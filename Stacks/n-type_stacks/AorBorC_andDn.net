*cfr3-(BorCorD)andAn -- Independent signal generators and Vdd power supply
*((AorBorC)andD)n

.INCLUDE ../../45nm_MGK.pm
.OPTIONS GMIN=1e-020 ABSTOL=1e-018

.PARAM Lmin=45n
.PARAM Ldiff=90n
.PARAM Wmin=45n

Vdd alim 0
Va A 0
Vb B 0
Vc C 0
Vd D 0

Mn1 SD1		A 	0 	0 	nmos 	W={2*Wmin} L={Lmin} AS={Ldiff*2*Wmin} AD={Ldiff*2*Wmin} PS={2*(Ldiff+2*Wmin)} PD={2*(Ldiff+2*Wmin)}
Mn2 SD1 	B 	0 	0 	nmos 	W={2*Wmin} L={Lmin} AS={Ldiff*2*Wmin} AD={Ldiff*2*Wmin} PS={2*(Ldiff+2*Wmin)} PD={2*(Ldiff+2*Wmin)}
Mn3 SD1 	C 	0 	0 	nmos 	W={2*Wmin} L={Lmin} AS={Ldiff*2*Wmin} AD={Ldiff*2*Wmin} PS={2*(Ldiff+2*Wmin)} PD={2*(Ldiff+2*Wmin)}
Mn4 alim 	D 	SD1 	0 	nmos 	W={2*Wmin} L={Lmin} AS={Ldiff*2*Wmin} AD={Ldiff*2*Wmin} PS={2*(Ldiff+2*Wmin)} PD={2*(Ldiff+2*Wmin)}

.CONTROL
let Ldiff=90n
foreach Vddbasic 1.0

echo Vddbasic = $Vddbasic
  alter Vdd = $Vddbasic
foreach width 45n
    echo 
    echo
	echo WMIN=$width
	echo
    
    *foreach input 0 $Vddbasic
	*   alter Vdd= $input
	*	alter Cout ic = $input
	    			foreach input 0 $Vddbasic
 	        		alter Va = $input
 	        			foreach input 0 $Vddbasic
		        		alter Vb = $input
			    			foreach input 0 $Vddbasic
			        		alter Vc = $input
		                     			foreach input 0 $Vddbasic
                                            			alter Vd=$input
                                            *if not(@Vdd[DC] & @Vb[DC] & (@Va[DC] or @Vd[DC] or @Vc[DC]))
			                    *    alter Cout ic = $Vddbasic
		                            *else
			                    *    alter Cout ic = 0
		                            *end
		                        *    show Cout : ic
			                    echo DC Analysis at 30C and 90C
		                            dc TEMP 30 90 60
			                    print V(SD1) ((V(A)*I(Va))+(V(B)*I(Vb))+(V(C)*I(Vc))+(V(D)*I(Vd))+(V(alim)*I(Vdd))) V(alim) V(A) V(B) V(C) V(D) 
													
													set filetype=ascii
													set wr_singlescale
													set wr_vecnames
													set appendwrite
													wrdata AorBorC_andDn.txt V(SD1) ((V(A)*I(Va))+(V(B)*I(Vb))+(V(C)*I(Vc))+(V(D)*I(Vd))+(V(alim)*I(Vdd))) V(alim) V(A) V(B) V(C) V(D)
			                    *nota: somma delle pootenze con segni eprke tutta la potenza dei generatori si dissipa sul carico compreso...
				        	*dc TEMP 30 90 60 Vdd 0.8 1.2 0.1 
			                        *print V(SD1) V(alim) V(A) V(B) V(C) V(SD) V(SD2)  I(Va) I(Vb)  I(Vc) I(Vdd) (abs(I(Va))+abs(I(Vb))+abs(I(Vc))+abs(I(Vdd)))
		                            end
                                      end
			     	end	
	          	end
	     	end	
	end
.ENDC
.END
