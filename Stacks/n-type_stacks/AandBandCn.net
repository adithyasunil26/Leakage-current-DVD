*cfr3-(CandBandA)n -- Independent signal generators and Vdd power supply
*(AandBandC)n

.INCLUDE ../../45nm_MGK.pm
.OPTIONS GMIN=1e-020 ABSTOL=1e-018

*Defining Parameters
.PARAM Lmin=45n
.PARAM Ldiff=90n
.PARAM Wmin=45n

Vdd alim 0
Va A 0
Vb B 0
Vc C 0
Mn1 SD2 	A 	0 	0 	nmos W={3*Wmin} L={Lmin} AS={Ldiff*3*Wmin} AD={Ldiff*3*Wmin} PS={2*(Ldiff+3*Wmin)} PD={2*(Ldiff+3*Wmin)}
Mn2 SD1 	B 	SD2 	0 	nmos W={3*Wmin} L={Lmin} AS={Ldiff*3*Wmin} AD={Ldiff*3*Wmin} PS={2*(Ldiff+3*Wmin)} PD={2*(Ldiff+3*Wmin)}
Mn3 alim 	C 	SD1 	0 	nmos W={3*Wmin} L={Lmin} AS={Ldiff*3*Wmin} AD={Ldiff*3*Wmin} PS={2*(Ldiff+3*Wmin)} PD={2*(Ldiff+3*Wmin)}

*Defining Analysis
.CONTROL
let Ldiff=90n
foreach Vddbasic 1.0

echo Vdd basic = $Vddbasic
alter Vdd = $Vddbasic
foreach width 45n
	echo 
	echo
	echo WMIN=$width
	echo

	    foreach ingresso 0 $Vddbasic
 	        alter Va = $ingresso
 	         foreach ingresso 0 $Vddbasic
		    alter Vb = $ingresso
		      foreach ingresso 0 $Vddbasic
		        alter Vc = $ingresso
		                     
                                    * if not(@Vdd[DC] & @Va[DC] & @Vb[DC] & @Vc[DC])
			                    **    alter Cout ic = $Vddbasic
		                        **    else
			                    **    alter Cout ic = 0
		                        **    end
		                            *show Cout : ic
			    echo DC Analysis at 30C and 90C
		                            dc TEMP 30 90 60
			                    print V(SD1) V(SD2) ((V(A)*I(Va))+(V(B)*I(Vb))+(V(C)*I(Vc))+(V(alim)*I(Vdd))) V(alim) V(A) V(B) V(C)
			    
					set filetype=ascii
					set wr_singlescale
					set wr_vecnames
					set appendwrite

					wrdata AandBandCn.txt V(SD1) V(SD2) ((V(A)*I(Va))+(V(B)*I(Vb))+(V(C)*I(Vc))+(V(alim)*I(Vdd))) V(alim) V(A) V(B) V(C)
				        	*dc TEMP 30 90 60 Vdd 0.8 1.2 0.1 
			                        *print V(SD1) V(SD2) V(alim) V(A) V(B) V(C) V(SD) V(SD2)  I(Va) I(Vb)  I(Vc) I(Vdd) (abs(I(Va))+abs(I(Vb))+abs(I(Vc))+abs(I(Vdd)))
		                           
                                    end
			     end	
	          end
	     end	
    end
end
end
.ENDC
.END
